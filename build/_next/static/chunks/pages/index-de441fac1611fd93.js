(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(8489)}])},8489:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return pages}});var a=n(5893),s=n(7294),l=n(9008),i=n.n(l),u=n(3920),r=n(4298),o=n.n(r),c=n(3793),d=n(5675),m=n.n(d),v=n(1001);let PageLayout=e=>{let{children:t,resetDetailsFn:n}=e;return(0,a.jsxs)("div",{className:"relative xs:px-2 2xs:px-4 top-0 left-0 z-[30] w-full h-screen flex justify-center items-center",children:[(0,a.jsx)(m(),{src:"/icons/close-icon.svg",alt:"",width:40,height:40,className:"absolute z-[40] top-6 right-10 cursor-pointer rounded-full 2xs:top-4 2xs:right-4 2xs:w-[20px] 2xs:h-[20px]",onClick:()=>{(0,v.Xv)("close"),n()}}),t]})};var p=n(7085),f=n(1255),pages=()=>{let e=(0,s.useRef)(null),t=(0,s.useRef)(!1),[n,l]=(0,s.useState)("type"),[r,d]=(0,s.useState)(null),[m,y]=(0,s.useState)(!1),[g,h]=(0,s.useState)(""),[x,w]=(0,s.useState)(null),[N,b]=(0,s.useState)(null),[D,j]=(0,s.useState)(!0),[E,F]=(0,s.useState)(""),[S,_]=(0,s.useState)(null),handlePaymentInitiation=e=>{null==e||e.preventDefault(),d(null==e?void 0:e.data)},getPaymentOptions=async()=>{var e,t,n;j(!0),F("");try{let{data:t}=await f.u.get("/merchant/payment-options",{params:{publicKey:null==r?void 0:r.publicKey,currency:null==r?void 0:r.currency}});_(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.options)}catch(e){F((null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message)||(null==e?void 0:e.message))}finally{j(!1)}};(0,s.useEffect)(()=>(window.addEventListener("message",handlePaymentInitiation),()=>window.removeEventListener("message",handlePaymentInitiation)),[]),(0,s.useEffect)(()=>{(null==r?void 0:r.customerName)&&getPaymentOptions()},[null==r?void 0:r.customerName]),(0,s.useEffect)(()=>{if(!t.current){t.current=!0;return}e.current=(0,u.io)(p.v.SERVER_URL),e.current.on("".concat(null==x?void 0:x.reference,"-").concat(null==x?void 0:x.accountNumber),e=>{b(e)})},[null==x?void 0:x.reference,null==x?void 0:x.accountNumber,null==x?void 0:x.sessionKey,t]);let generateAccountNumberFn=async()=>{y(!0),h("");try{let{data:e}=await f.u.post("/accounts/initiate",{data:(0,v.HI)(JSON.stringify({customerName:null==r?void 0:r.customerName,reference:null==r?void 0:r.reference,amount:null==r?void 0:r.amount,email:null==r?void 0:r.email}),r.publicKey),clientId:r.clientId});w(null==e?void 0:e.data)}catch(n){var e,t;h((null==n?void 0:null===(t=n.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Transaction could not be initiated")}finally{y(!1)}},resetDetailsFn=e=>{e?d(e):d(null),w(null),b(null),l("type")};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i(),{children:[(0,a.jsx)("title",{children:"Pay with providus"}),(0,a.jsx)("meta",{name:"description",content:"A payment gateway with providus"})]}),(0,a.jsx)(PageLayout,{resetDetailsFn:resetDetailsFn,children:(()=>{switch(n){case"transfer":return(0,a.jsx)(c.hB,{setType:l,customerDetails:r,accountDetails:x,paymentDetails:N,generateAccountNumberFn:generateAccountNumberFn,loading:m,error:g,resetDetailsFn:resetDetailsFn,setError:h});case"card":return(0,a.jsx)(c.vu,{setStatus:l,customerDetails:r});default:return(0,a.jsx)(c.DH,{setStatus:l,customerDetails:r,generateAccountNumberFn:generateAccountNumberFn,resetDetailsFn:resetDetailsFn,loading:D,error:E,optionDetails:S,getPaymentOptions:getPaymentOptions})}})()}),(0,a.jsx)(o(),{type:"text/javascript",src:"https://ap-gateway.mastercard.com/static/checkout/checkout.min.js","data-complete":"completeCallback",strategy:"afterInteractive"})]})}}},function(e){e.O(0,[448,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);